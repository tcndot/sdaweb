<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SDA Promoters</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div id="headerdiv"></div>
    <main class="main-content home-hero-row">
      <div class="home-left">
        <h1 id="bigHeading">Please wait...</h1>
        <p id="subHeading"></p>
        <a id="knowMoreBtn" class="home-cta-btn" href="#">Know more about us</a>
        <!-- TEST FIELD TO SHOW COMPANY NAME FROM data.json -->
        <div id="testDataField" style="margin-top:20px;font-weight:bold;color:green;"></div>
      </div>
      <div class="home-right">
        <div class="carousel-box">
          <img id="carouselImage" src="" alt="Gallery Image" class="carousel-img"/>
        </div>
      </div>
    </main>
    <div id="footerdiv"></div>
    <script>
      // Helper function to set text
      function setText(id, value) {
        let e = document.getElementById(id);
        if (e) e.textContent = value;
      }

      // Site-wide and homepage data
      let siteData = {};
      let homeData = {};

      async function fetchSiteData() {
        const response = await fetch("data.json");
        siteData = await response.json();
        setSiteData(siteData);
      }

      function setSiteData(s) {
        // TEST: Display company name from data.json
        setText("testDataField", s.companyNameTop);

        // You can add more fields here to show they load correctly.
      }

      async function fetchHomeData() {
        try {
          const response = await fetch("homepagedata.json");
          homeData = await response.json();
          setHomeData(homeData);
        } catch (e) {
          console.error("Failed to load homepagedata.json:", e);
        }
      }

      function setHomeData(h) {
        setText("bigHeading", h.bigHeading);
        setText("subHeading", h.subHeading);
        let btn = document.getElementById("knowMoreBtn");
        btn.textContent = h.ctaText;
        btn.href = h.ctaLink;
        if (h.carouselImages && h.carouselImages.length > 0) {
          document.getElementById("carouselImage").src = h.carouselImages[0];
        }
      }

      async function loadHTML(id, url) {
        const response = await fetch(url);
        if (response.ok) {
          document.getElementById(id).innerHTML = await response.text();
        }
      }

      async function init() {
        // Load header and footer first
        await loadHTML("headerdiv", "header.html");
        await loadHTML("footerdiv", "footer.html");
        await fetchSiteData();
        await fetchHomeData();
      }
      // Run everything
      init();
    </script>
  </body>
</html>
