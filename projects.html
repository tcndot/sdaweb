---
layout: default
title: Projects
permalink: /projects/
---

<section class="py-12">

  <h1 class="text-3xl font-extrabold text-center mb-12">
    Our Projects
  </h1>

  {% assign projects_sorted = site.projects | sort: "title" %}

  {% for p in projects_sorted %}
    {% if p.title %}

      <!-- CARD WRAPPER (clickable) -->
      <a href="{{ p.url | relative_url }}"
         class="block max-w-3xl mx-auto mb-24 border rounded-xl shadow-sm overflow-hidden bg-white hover:shadow-md transition">

        <!-- TITLE -->
        <div class="p-6 border-b text-center">
          <h2 class="text-2xl font-bold">
            {{ p.title }}
          </h2>
        </div>

        <!-- IMAGE AREA -->
        <div class="relative project-rotator">

          {% assign slides = "" | split: "" %}

          {%- comment -%} Map first (mini) {%- endcomment -%}
          {% if p.map_image %}
            {% assign slides = slides | push: p.map_image %}
          {% endif %}

          {%- comment -%} Gallery images next {%- endcomment -%}
          {% if p.gallery %}
            {% for img in p.gallery limit:2 %}
              {% assign slides = slides | push: img %}
            {% endfor %}
          {% elsif p.image %}
            {% assign slides = slides | push: p.image %}
          {% endif %}

          {% if slides.size > 0 %}
            {% for img in slides %}
              <img
                src="{{ img | relative_url }}"
                alt="{{ p.title }}"
                class="rot-slide absolute inset-0 w-full object-cover opacity-0 transition-opacity duration-700"
                data-type="{% if forloop.first %}map{% else %}image{% endif %}"
                loading="lazy">
            {% endfor %}
          {% else %}
            <div class="w-full h-64 bg-gray-200 flex items-center justify-center text-gray-500">
              No image available
            </div>
          {% endif %}
        </div>

        <!-- TEXT (ALWAYS VISIBLE) -->
        <div class="p-6 text-center">
          {% if p.listing and p.listing.highlight %}
            <div class="font-semibold mb-2">
              {{ p.listing.highlight }}
            </div>
          {% endif %}

          {% if p.listing and p.listing.summary %}
            <div class="text-gray-700">
              {{ p.listing.summary }}
            </div>
          {% endif %}
        </div>

      </a>

    {% endif %}
  {% endfor %}
</section>

<!-- ROTATION SCRIPT -->
<script>
  document.querySelectorAll('.project-rotator').forEach(rotator => {
    const slides = rotator.querySelectorAll('.rot-slide');
    if (slides.length <= 1) return;

    let i = 0;

    slides.forEach(slide => {
      if (slide.dataset.type === 'map') {
        slide.style.height = '220px';
      } else {
        slide.style.height = '380px';
      }
    });

    slides[0].classList.add('opacity-100');

    setInterval(() => {
      slides[i].classList.remove('opacity-100');
      i = (i + 1) % slides.length;
      slides[i].classList.add('opacity-100');
    }, 3500);
  });
</script>

<style>
  @media (max-width: 640px) {
    .rot-slide[data-type="map"] {
      height: 160px !important;
    }
    .rot-slide[data-type="image"] {
      height: 240px !important;
    }
  }
</style>
